!function(e){if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof module&&void 0!==module.exports){var t=e();Object.defineProperty(exports,"__esModule",{value:!0}),exports.autocomplete=t,exports.default=t}else window.autocomplete=e()}(function(){"use strict";function e(e){function t(){var e=L.parentNode;e&&e.removeChild(L)}function n(){x&&window.clearTimeout(x)}function o(){L.parentNode||C.body.appendChild(L)}function i(){return!!L.parentNode}function r(){D++,H=[],M="",E=void 0,t()}function f(){var e=C.documentElement,t=e.clientTop||C.body.clientTop||0,n=e.clientLeft||C.body.clientLeft||0,o=window.pageYOffset||e.scrollTop,i=window.pageXOffset||e.scrollLeft,r=w.getBoundingClientRect(),f=r.top+w.offsetHeight+o-t,l=r.left+i-n;b.top=f+"px",b.left=l+"px",b.width=w.offsetWidth+"px",b.maxHeight=window.innerHeight-f+"px",b.height="auto"}function l(){for(;L.firstChild;)L.removeChild(L.firstChild);var t=!1,n="#9?$";H.forEach(function(e){e.group&&(t=!0)});var i=function(e,t){var n=C.createElement("div");return n.textContent=e.label||"",n};e.render&&(i=e.render);var l=function(e,t){var n=C.createElement("div");return n.textContent=e,n};e.renderGroup&&(l=e.renderGroup);var d=C.createDocumentFragment();if(H.forEach(function(t){if(t.group&&t.group!==n){n=t.group;var o=l(t.group,M);o&&(o.className+=" group",d.appendChild(o))}var f=i(t,M);f&&(f.addEventListener("click",function(n){e.onSelect(t,w),r(),n.preventDefault(),n.stopPropagation()}),t===E&&(f.className+=" selected"),d.appendChild(f))}),L.appendChild(d),H.length<1){if(!e.emptyMsg)return void r();var a=C.createElement("div");a.className="empty",a.textContent=e.emptyMsg,L.appendChild(a)}o(),f(),s()}function d(){i()&&l()}function a(){d()}function u(){d()}function c(t){for(var o=t.which||t.keyCode||0,f=++D,d=[38,13,27,39,37,16,17,18,20,91,9],a=0,u=d;a<u.length;a++){if(o===u[a])return}if(40!==o||!i()){var c=w.value;c.length>=S?(n(),x=window.setTimeout(function(){e.fetch(c,function(e){D===f&&e&&!y&&(H=e,M=c,E=H.length>0?H[0]:void 0,l())})},k)):r()}}function s(){var e=L.getElementsByClassName("selected");if(e.length>0){var t=e[0],n=t.previousElementSibling;if(n&&-1!==n.className.indexOf("group")&&!n.previousElementSibling&&(t=n),t.offsetTop<L.scrollTop)L.scrollTop=t.offsetTop;else{var o=t.offsetTop+t.offsetHeight,i=L.scrollTop+L.offsetHeight;o>i&&(L.scrollTop+=o-i)}}}function p(){if(H.length<1)E=void 0;else if(E===H[0])E=H[H.length-1];else for(var e=H.length-1;e>0;e--)if(E===H[e]||1===e){E=H[e-1];break}}function v(){if(H.length<1&&(E=void 0),!E||E===H[H.length-1])return void(E=H[0]);for(var e=0;e<H.length-1;e++)if(E===H[e]){E=H[e+1];break}}function m(t){var n=t.which||t.keyCode||0;if(38===n||40===n||27===n){var o=i();if(27===n)r();else{if(!i||H.length<1)return;38===n?p():v(),l()}return t.preventDefault(),void(o&&t.stopPropagation())}13===n&&E&&(e.onSelect(E,w),r())}function g(){setTimeout(function(){C.activeElement!==w&&r()},200)}function h(){y=!0,w.removeEventListener("keydown",m),w.removeEventListener(O,c),w.removeEventListener("blur",g),window.removeEventListener("resize",a),document.removeEventListener("scroll",u,!0),n(),r()}var w,E,y,x,C=document,L=C.createElement("div"),b=L.style,T=navigator.userAgent,N=-1!==T.indexOf("Firefox")&&-1!==T.indexOf("Mobile"),k=e.debounceWaitMs||0,O=N?"input":"keyup",H=[],M="",S=e.minLength||2,D=0;if(!e.input)throw new Error("input undefined");return w=e.input,L.className="autocomplete "+(e.className||""),b.position="absolute",f(),w.addEventListener("keydown",m),w.addEventListener(O,c),w.addEventListener("blur",g),window.addEventListener("resize",a),document.addEventListener("scroll",u,!0),{destroy:h}}return e});