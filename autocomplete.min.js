!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).autocomplete=t()}(this,(function(){"use strict";return function(e){var t=document,n=e.container||t.createElement("div");n.id=n.id||"autocomplete-"+m();var i,r,o=n.style,a=e.debounceWaitMs||0,s=e.preventSubmit||!1,u=e.disableAutoSelect||!1,d=[],c="",l=2,f=e.showOnFocus,p=0;if(void 0!==e.minLength&&(l=e.minLength),!e.input)throw new Error("input undefined");var v=e.input;function m(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}function b(){r&&window.clearTimeout(r)}function g(){return!!n.parentNode}function h(){var e;p++,d=[],c="",i=void 0,v.setAttribute("aria-activedescendant",""),v.setAttribute("aria-expanded","false"),(e=n.parentNode)&&e.removeChild(n)}function E(){for(;n.firstChild;)n.removeChild(n.firstChild);v.setAttribute("aria-activedescendant","");var r=function(e,n,i){var r=t.createElement("div");return r.textContent=e.label||"",r};e.render&&(r=e.render);var a=function(e,n){var i=t.createElement("div");return i.textContent=e,i};e.renderGroup&&(a=e.renderGroup);var s=t.createDocumentFragment(),u="#9?$";if(d.forEach((function(t,o){if(t.group&&t.group!==u){u=t.group;var d=a(t.group,c);d&&(d.className+=" group",s.appendChild(d))}var l=r(t,c,o);l&&(l.id=n.id+"_"+o,l.setAttribute("role","option"),l.addEventListener("click",(function(n){e.onSelect(t,v),h(),n.preventDefault(),n.stopPropagation()})),t===i&&(l.className+=" selected",l.setAttribute("aria-selected","true"),v.setAttribute("aria-activedescendant",l.id)),s.appendChild(l))})),n.appendChild(s),d.length<1){if(!e.emptyMsg)return void h();var l=t.createElement("div");l.id=n.id+"_"+m(),l.className="empty",l.textContent=e.emptyMsg,n.appendChild(l),v.setAttribute("aria-activedescendant",l.id)}n.parentNode||t.body.appendChild(n),function(){if(g()){v.setAttribute("aria-expanded","true"),o.height="auto",o.width=v.offsetWidth+"px";var i,r=0;a(),a(),e.customize&&i&&e.customize(v,i,n,r)}function a(){var e=t.documentElement,n=e.clientTop||t.body.clientTop||0,a=e.clientLeft||t.body.clientLeft||0,s=window.pageYOffset||e.scrollTop,u=window.pageXOffset||e.scrollLeft,d=(i=v.getBoundingClientRect()).top+v.offsetHeight+s-n,c=i.left+u-a;o.top=d+"px",o.left=c+"px",(r=window.innerHeight-(i.top+v.offsetHeight))<0&&(r=0),o.top=d+"px",o.bottom="",o.left=c+"px",o.maxHeight=r+"px"}}(),function(){var e=n.getElementsByClassName("selected");if(e.length>0){var t=e[0],i=t.previousElementSibling;if(i&&-1!==i.className.indexOf("group")&&!i.previousElementSibling&&(t=i),t.offsetTop<n.scrollTop)n.scrollTop=t.offsetTop;else{var r=t.offsetTop+t.offsetHeight,o=n.scrollTop+n.offsetHeight;r>o&&(n.scrollTop+=r-o)}}}()}function w(){g()&&E()}function A(){w()}function L(e){e.target!==n?w():e.preventDefault()}function y(){T(0)}function x(t){var n=t.key;if("ArrowUp"===n||"ArrowDown"===n||"Escape"===n){var r=g();if("Escape"===n)h();else{if(!r||d.length<1)return;"ArrowUp"===n?function(){if(d.length<1)i=void 0;else if(i===d[0])i=d[d.length-1];else for(var e=d.length-1;e>0;e--)if(i===d[e]||1===e){i=d[e-1];break}}():function(){if(d.length<1&&(i=void 0),i&&i!==d[d.length-1]){for(var e=0;e<d.length-1;e++)if(i===d[e]){i=d[e+1];break}}else i=d[0]}(),E()}return t.preventDefault(),void(r&&t.stopPropagation())}"Enter"===n&&(i&&(e.onSelect(i,v),h()),s&&t.preventDefault())}function k(){f&&T(1)}function T(t){var n=++p,o=v.value,s=v.selectionStart||0;o.length>=l||1===t?(b(),r=window.setTimeout((function(){e.fetch(o,(function(e){p===n&&e&&(c=o,i=(d=e).length<1||u?void 0:d[0],E())}),t,s)}),0===t||2===t?a:0)):h()}function C(t){e.keyup?e.keyup({event:t,fetch:function(){return T(0)}}):g()||"ArrowDown"!==t.key||T(0)}function N(t){e.click&&e.click({event:t,fetch:function(){return T(2)}})}function D(){setTimeout((function(){t.activeElement!==v&&h()}),200)}return n.className="autocomplete "+(e.className||""),n.setAttribute("role","listbox"),v.setAttribute("role","combobox"),v.setAttribute("aria-expanded","false"),v.setAttribute("aria-autocomplete","list"),v.setAttribute("aria-controls",n.id),v.setAttribute("aria-owns",n.id),v.setAttribute("aria-activedescendant",""),v.setAttribute("aria-haspopup","listbox"),o.position="absolute",n.addEventListener("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),n.addEventListener("focus",(function(){return v.focus()})),v.addEventListener("keyup",C),v.addEventListener("click",N),v.addEventListener("keydown",x),v.addEventListener("input",y),v.addEventListener("blur",D),v.addEventListener("focus",k),window.addEventListener("resize",A),t.addEventListener("scroll",L,!0),{destroy:function(){v.removeEventListener("focus",k),v.removeEventListener("keyup",C),v.removeEventListener("click",N),v.removeEventListener("keydown",x),v.removeEventListener("input",y),v.removeEventListener("blur",D),window.removeEventListener("resize",A),t.removeEventListener("scroll",L,!0),v.removeAttribute("role"),v.removeAttribute("aria-expanded"),v.removeAttribute("aria-autocomplete"),v.removeAttribute("aria-controls"),v.removeAttribute("aria-activedescendant"),v.removeAttribute("aria-owns"),v.removeAttribute("aria-haspopup"),b(),h()}}}}));
//# sourceMappingURL=autocomplete.min.js.map
