!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).autocomplete=t()}(this,(function(){"use strict";return function(e){var t=document,n=e.container||t.createElement("div"),i=n.id;if(!i||!i.length){var o=0;do{i="autocomplete-"+o++}while(null!=t.getElementById(i)&&o<1e5);n.id=i}var r,a,l=n.style,s=navigator.userAgent,u=~s.indexOf("Firefox")&&~s.indexOf("Mobile"),d=e.debounceWaitMs||0,f=e.preventSubmit||!1,c=e.disableAutoSelect||!1,p=u?"input":"keyup",v=[],m="",g=2,h=e.showOnFocus,b=0;if(void 0!==e.minLength&&(g=e.minLength),!e.input)throw new Error("input undefined");var E=e.input;function w(){a&&window.clearTimeout(a)}function x(){return!!n.parentNode}function y(){var e;b++,v=[],m="",r=void 0,E.setAttribute("aria-activedescendant",""),E.setAttribute("aria-expanded","false"),(e=n.parentNode)&&e.removeChild(n)}function L(){for(;n.firstChild;)n.removeChild(n.firstChild);var o=function(e,n){var i=t.createElement("div");return i.textContent=e.label||"",i};e.render&&(o=e.render);var a=function(e,n){var i=t.createElement("div");return i.textContent=e,i};e.renderGroup&&(a=e.renderGroup);var s=t.createDocumentFragment(),u="#9?$";if(v.forEach((function(t,n){if(t.group&&t.group!==u){u=t.group;var l=a(t.group,m);l&&(l.className+=" group",s.appendChild(l))}var d=o(t,m);d&&(d.id=i+"_"+n,d.setAttribute("aria-role","option"),d.addEventListener("click",(function(n){e.onSelect(t,E),y(),n.preventDefault(),n.stopPropagation()})),t===r&&(d.className+=" selected",d.setAttribute("aria-selected","true"),E.setAttribute("aria-activedescendant",d.id)),s.appendChild(d))})),n.appendChild(s),v.length<1){if(!e.emptyMsg)return void y();var d=t.createElement("div");d.className="empty",d.textContent=e.emptyMsg,n.appendChild(d)}n.parentNode||t.body.appendChild(n),function(){if(x()){E.setAttribute("aria-expanded","true"),l.height="auto",l.width=E.offsetWidth+"px";var i,o=0;r(),r(),e.customize&&i&&e.customize(E,i,n,o)}function r(){var e=t.documentElement,n=e.clientTop||t.body.clientTop||0,r=e.clientLeft||t.body.clientLeft||0,a=window.pageYOffset||e.scrollTop,s=window.pageXOffset||e.scrollLeft,u=(i=E.getBoundingClientRect()).top+E.offsetHeight+a-n,d=i.left+s-r;l.top=u+"px",l.left=d+"px",(o=window.innerHeight-(i.top+E.offsetHeight))<0&&(o=0),l.top=u+"px",l.bottom="",l.left=d+"px",l.maxHeight=o+"px"}}(),function(){var e=n.getElementsByClassName("selected");if(e.length>0){var t=e[0],i=t.previousElementSibling;if(i&&-1!==i.className.indexOf("group")&&!i.previousElementSibling&&(t=i),t.offsetTop<n.scrollTop)n.scrollTop=t.offsetTop;else{var o=t.offsetTop+t.offsetHeight,r=n.scrollTop+n.offsetHeight;o>r&&(n.scrollTop+=o-r)}}}()}function A(){x()&&L()}function T(){A()}function C(e){e.target!==n?A():e.preventDefault()}function k(t){for(var n=t.which||t.keyCode||0,i=0,o=e.keysToIgnore||[38,13,27,39,37,16,17,18,20,91,9];i<o.length;i++){if(n===o[i])return}n>=112&&n<=123&&!e.keysToIgnore||40===n&&x()||D(0)}function N(t){var n=t.which||t.keyCode||0;if(38===n||40===n||27===n){var i=x();if(27===n)y();else{if(!i||v.length<1)return;38===n?function(){if(v.length<1)r=void 0;else if(r===v[0])r=v[v.length-1];else for(var e=v.length-1;e>0;e--)if(r===v[e]||1===e){r=v[e-1];break}}():function(){if(v.length<1&&(r=void 0),r&&r!==v[v.length-1]){for(var e=0;e<v.length-1;e++)if(r===v[e]){r=v[e+1];break}}else r=v[0]}(),L()}return t.preventDefault(),void(i&&t.stopPropagation())}13===n&&(r&&(e.onSelect(r,E),y()),f&&t.preventDefault())}function S(){h&&D(1)}function D(t){var n=++b,i=E.value,o=E.selectionStart||0;i.length>=g||1===t?(w(),a=window.setTimeout((function(){e.fetch(i,(function(e){b===n&&e&&(m=i,r=(v=e).length<1||c?void 0:v[0],L())}),t,o)}),0===t?d:0)):y()}function H(){setTimeout((function(){t.activeElement!==E&&y()}),200)}return n.className="autocomplete "+(e.className||""),E.setAttribute("aria-role","combobox"),E.setAttribute("aria-expanded","false"),E.setAttribute("aria-autocomplete","list"),E.setAttribute("aria-controls",i),E.setAttribute("aria-activedescendant",""),n.setAttribute("aria-role","listbox"),l.position="absolute",n.addEventListener("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),n.addEventListener("focus",(function(){return E.focus()})),E.addEventListener("keydown",N),E.addEventListener(p,k),E.addEventListener("blur",H),E.addEventListener("focus",S),window.addEventListener("resize",T),t.addEventListener("scroll",C,!0),{destroy:function(){E.removeEventListener("focus",S),E.removeEventListener("keydown",N),E.removeEventListener(p,k),E.removeEventListener("blur",H),window.removeEventListener("resize",T),t.removeEventListener("scroll",C,!0),E.removeAttribute("aria-role"),E.removeAttribute("aria-expanded"),E.removeAttribute("aria-autocomplete"),E.removeAttribute("aria-controls"),E.removeAttribute("aria-activedescendant"),w(),y()}}}}));
//# sourceMappingURL=autocomplete.min.js.map
